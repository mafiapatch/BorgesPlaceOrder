import{d as i}from"./dataService.02d58fab.js";import{_ as b,o as c,c as _,b as t,d,e as p,v as m,t as n,F as f,g as k,B as v}from"./index.98db41d3.js";const O={name:"adminOrderList",components:{},data(){return{email:"",password:"",orderList:[],orderCount:0,searchKey:"pickup_date",startAt:new Date().toISOString().split("T")[0],endAt:new Date().toISOString().split("T")[0]}},methods:{getOrderRealTime(){let o=i.getAllOrder(),s=this.searchKey,a=Date.parse(this.startAt),h=Date.parse(this.endAt);o.orderByChild(s).startAt(a).endAt(h).once("value",l=>{this.processData(l)})},processData(o){let s=[];for(let a in o.val())s.push({...o.val()[a],key:a});this.orderList=s.reverse(),this.orderCount=s.length},updateOrder(){for(let o in this.orderList)i.updateOrder({order_status:this.orderList[o].order_status},this.orderList[o].key);alert("\u4FEE\u6539\u6210\u529F")},logOut(){i.auth().signOut().then(()=>{i.auth().onAuthStateChanged(()=>{this.$router.push({name:"adminLogin"})})})}},created(){this.endAt=new Date(new Date().setMonth(new Date().getMonth()+1)).toISOString().split("T")[0]},mounted(){i.checkAuth(),this.getOrderRealTime()}},y={class:"container mt-5"},A={class:"row d-flex justify-content-center"},L={class:"col-md-12"},S={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},D=t("a",{class:"nav-link active",href:"/admin/orderlist",role:"tab","aria-selected":"true"},"\u8A02\u55AE\u8A2D\u5B9A",-1),w=t("a",{class:"nav-link",href:"/admin/productList",role:"tab","aria-selected":"false"},"\u5546\u54C1\u8A2D\u5B9A",-1),T=t("a",{class:"nav-link",href:"/admin/setting",role:"tab","aria-selected":"false"},"\u7CFB\u7D71\u8A2D\u5B9A",-1),x={class:"row mt-3"},C={class:"col-md-2"},B=t("option",{value:"created_ts"},"\u8A02\u55AE\u5EFA\u7ACB\u6642\u9593",-1),V=t("option",{value:"pickup_date"},"\u53D6\u8CA8\u6642\u9593",-1),I=[B,V],R={class:"col-md-2"},U=t("div",{class:"col-md-1"},[t("p",{class:"text-center"},"\u81F3")],-1),M={class:"col-md-2"},K={class:"col-md-2"},F={class:"col-md-2 text-end"},j={class:"table mt-3"},E=t("thead",null,[t("tr",null,[t("th",null,"\u5546\u54C1\u540D\u7A31"),t("th",null,"\u5206\u5E97"),t("th",null,"\u53D6\u8CA8\u65E5\u671F"),t("th",null,"\u53D6\u8CA8\u6642\u9593"),t("th",null,"\u8A02\u55AE\u5EFA\u7ACB\u65E5\u671F"),t("th",null,"\u8A02\u8CFC\u91CF"),t("th",null,"\u8A02\u55AE\u91D1\u984D"),t("th",null,"\u8A02\u8CFC\u8005\u59D3\u540D"),t("th",null,"\u8A02\u8CFC\u8005\u624B\u6A5F"),t("th",null,"\u8A02\u55AE\u72C0\u614B")])],-1),N=t("option",{value:"\u672A\u53D6\u8CA8"},"\u672A\u53D6\u8CA8",-1),q=t("option",{value:"\u5DF2\u53D6\u8CA8"},"\u5DF2\u53D6\u8CA8",-1),z=t("hr",null,null,-1);function G(o,s,a,h,l,r){return c(),_("div",y,[t("div",A,[t("div",L,[t("nav",null,[t("div",S,[D,w,T,t("button",{class:"nav-link",id:"nav-profile-tab","data-bs-toggle":"tab",type:"button",role:"tab",onClick:s[0]||(s[0]=(...e)=>r.logOut&&r.logOut(...e))},"\u767B\u51FA")])]),t("div",x,[t("div",C,[d(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>l.searchKey=e),class:"form-control"},I,512),[[p,l.searchKey]])]),t("div",R,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=e=>l.startAt=e)},null,512),[[m,l.startAt]])]),U,t("div",M,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=e=>l.endAt=e)},null,512),[[m,l.endAt]])]),t("div",K,[t("button",{class:"btn btn-primary",onClick:s[4]||(s[4]=(...e)=>r.getOrderRealTime&&r.getOrderRealTime(...e))},"\u9001\u51FA")]),t("div",F," \u5171 "+n(l.orderCount)+" \u7B46\u8CC7\u6599 ",1)]),t("table",j,[E,t("tbody",null,[(c(!0),_(f,null,k(l.orderList,(e,u)=>(c(),_("tr",{key:u},[t("td",null,n(e.item_name),1),t("td",null,n(e.pickup_location),1),t("td",null,n(new Date(e.pickup_date).toISOString().split("T")[0]),1),t("td",null,n(e.pickup_time),1),t("td",null,n(new Date(e.created_ts).toISOString().split("T")[0]),1),t("td",null,n(e.count),1),t("td",null,n(e.order_price),1),t("td",null,n(e.order_name),1),t("td",null,n(e.order_mobile),1),t("td",null,[s[5]||(v(-1),s[5]=d(t("select",{"onUpdate:modelValue":g=>l.orderList[u].order_status=g,class:"form-control",disabled:e.order_status=="\u5DF2\u53D6\u8CA8"},[N,q],8,["onUpdate:modelValue","disabled"]),[[p,l.orderList[u].order_status]]),v(1),s[5])])]))),128))])]),z,t("button",{class:"btn btn-secondary my-3",onClick:s[6]||(s[6]=(...e)=>r.updateOrder&&r.updateOrder(...e))},"\u5132\u5B58")])])])}var P=b(O,[["render",G]]);export{P as default};
