import{d as r}from"./dataService.50f846ff.js";import{_ as b,o as c,c as m,b as t,d,e as h,v as p,t as o,F as T,g as f,B as v}from"./index.20431d49.js";const k={name:"adminOrderList",components:{},data(){return{email:"",password:"",orderList:[],orderCount:0,searchKey:"pickup_date",startAt:new Date().toISOString().split("T")[0],endAt:new Date().toISOString().split("T")[0]}},methods:{timestampToTimezoneString(l){return new Date(l).toLocaleString("zh-TW",{timeZone:"Asia/Taipei",timeZoneName:"short"}).split(" ")[0]},timezoneStringToTimestamp(l){return new Date(l).getTime()},getOrderRealTime(){let l=r.getAllOrder(),e=this.searchKey,a=this.timezoneStringToTimestamp(this.startAt),_=this.timezoneStringToTimestamp(this.endAt);l.orderByChild(e).startAt(a).endAt(_).once("value",n=>{this.processData(n)})},processData(l){let e=[];for(let a in l.val())e.push({...l.val()[a],key:a});this.orderList=e.reverse(),this.orderCount=e.length},updateOrder(){for(let l in this.orderList)r.updateOrder({order_status:this.orderList[l].order_status},this.orderList[l].key);alert("\u4FEE\u6539\u6210\u529F")},logOut(){r.auth().signOut().then(()=>{r.auth().onAuthStateChanged(()=>{this.$router.push({name:"adminLogin"})})})}},created(){this.endAt=new Date(new Date().setMonth(new Date().getMonth()+1)).toISOString().split("T")[0]},mounted(){r.checkAuth(),this.getOrderRealTime()}},y={class:"container mt-5"},A={class:"row d-flex justify-content-center"},O={class:"col-md-12"},S={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},L=t("a",{class:"nav-link active",href:"/admin/orderlist",role:"tab","aria-selected":"true"},"\u8A02\u55AE\u8A2D\u5B9A",-1),w=t("a",{class:"nav-link",href:"/admin/productList",role:"tab","aria-selected":"false"},"\u5546\u54C1\u8A2D\u5B9A",-1),D=t("a",{class:"nav-link",href:"/admin/setting",role:"tab","aria-selected":"false"},"\u7CFB\u7D71\u8A2D\u5B9A",-1),x={class:"row mt-3"},C={class:"col-md-2"},z=t("option",{value:"created_ts"},"\u8A02\u55AE\u5EFA\u7ACB\u6642\u9593",-1),B=t("option",{value:"pickup_date"},"\u53D6\u8CA8\u6642\u9593",-1),V=[z,B],R={class:"col-md-2"},U=t("div",{class:"col-md-1"},[t("p",{class:"text-center"},"\u81F3")],-1),M={class:"col-md-2"},I={class:"col-md-2"},K={class:"col-md-2 text-end"},F={class:"table mt-3"},N=t("thead",null,[t("tr",null,[t("th",null,"\u5546\u54C1\u540D\u7A31"),t("th",null,"\u5206\u5E97"),t("th",null,"\u53D6\u8CA8\u65E5\u671F"),t("th",null,"\u53D6\u8CA8\u6642\u9593"),t("th",null,"\u8A02\u55AE\u5EFA\u7ACB\u65E5\u671F"),t("th",null,"\u8A02\u8CFC\u91CF"),t("th",null,"\u8A02\u55AE\u91D1\u984D"),t("th",null,"\u8A02\u8CFC\u8005\u59D3\u540D"),t("th",null,"\u8A02\u8CFC\u8005\u624B\u6A5F"),t("th",null,"\u8A02\u55AE\u72C0\u614B")])],-1),Z=t("option",{value:"\u672A\u53D6\u8CA8"},"\u672A\u53D6\u8CA8",-1),j=t("option",{value:"\u5DF2\u53D6\u8CA8"},"\u5DF2\u53D6\u8CA8",-1),E=t("hr",null,null,-1);function W(l,e,a,_,n,i){return c(),m("div",y,[t("div",A,[t("div",O,[t("nav",null,[t("div",S,[L,w,D,t("button",{class:"nav-link",id:"nav-profile-tab","data-bs-toggle":"tab",type:"button",role:"tab",onClick:e[0]||(e[0]=(...s)=>i.logOut&&i.logOut(...s))},"\u767B\u51FA")])]),t("div",x,[t("div",C,[d(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.searchKey=s),class:"form-control"},V,512),[[h,n.searchKey]])]),t("div",R,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>n.startAt=s)},null,512),[[p,n.startAt]])]),U,t("div",M,[d(t("input",{type:"date",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=s=>n.endAt=s)},null,512),[[p,n.endAt]])]),t("div",I,[t("button",{class:"btn btn-primary",onClick:e[4]||(e[4]=(...s)=>i.getOrderRealTime&&i.getOrderRealTime(...s))},"\u9001\u51FA")]),t("div",K," \u5171 "+o(n.orderCount)+" \u7B46\u8CC7\u6599 ",1)]),t("table",F,[N,t("tbody",null,[(c(!0),m(T,null,f(n.orderList,(s,u)=>(c(),m("tr",{key:u},[t("td",null,o(s.item_name),1),t("td",null,o(s.pickup_location),1),t("td",null,o(i.timestampToTimezoneString(s.pickup_date)),1),t("td",null,o(s.pickup_time),1),t("td",null,o(i.timestampToTimezoneString(s.created_ts)),1),t("td",null,o(s.count),1),t("td",null,o(s.order_price),1),t("td",null,o(s.order_name),1),t("td",null,o(s.order_mobile),1),t("td",null,[e[5]||(v(-1),e[5]=d(t("select",{"onUpdate:modelValue":g=>n.orderList[u].order_status=g,class:"form-control",disabled:s.order_status=="\u5DF2\u53D6\u8CA8"},[Z,j],8,["onUpdate:modelValue","disabled"]),[[h,n.orderList[u].order_status]]),v(1),e[5])])]))),128))])]),E,t("button",{class:"btn btn-secondary my-3",onClick:e[6]||(e[6]=(...s)=>i.updateOrder&&i.updateOrder(...s))},"\u5132\u5B58")])])])}var H=b(k,[["render",W]]);export{H as default};
